{% extends 'base.html' %} {% block content %}

<div class="flex justify-center">
  <div class="container flex justify-center">
    <form method="post"
      class="rounded-lg border bg-card text-card-foreground shadow-sm justify-self-center w-full max-w-md p-4"
      enctype="multipart/form-data">


      <div class="flex flex-col space-y-2">
        <h3 class="whitespace-nowrap text-2xl font-semibold leading-none tracking-tight">
          Edit film
        </h3>
        <p class="text-sm text-muted-foreground">Edit collums that you want</p>

      </div>
      <div class="">
        <div class="space-y-2">
          <div class="space-y-2">
            <label class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
              for="title">
              Title
            </label>
            <input name="title" id="title"
              class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
              type="text" required="true" value="{{film.title}}" />
          </div>
          <div class="space-y-2">
            <label class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
              for="description">
              Description
            </label>
            <textarea
              class="flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
              id="description" name="description" rows="4" value={{film.description}}>{{film.description}}</textarea>
          </div>
        </div>
        <div class="space-y-2">
          <label class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
            for="release_year">
            Release Year
          </label>
          <input name="release_year" id="release_year"
            class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
            type="number" required="true" value={{film.release_year}} />
        </div>
        <div class="space-y-2">
          <label class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
            for="length">
            Length
          </label>
          <input name="length" id="length"
            class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
            type="number" required="true" value={{film.length}} />
        </div>
        <div class="space-y-2">
          <label class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
            for="director">
            Director
          </label>
          <input name="director" id="director"
            class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
            type="text" required="true" value="{{film.director.name}}" />
          <div class="" id="showdirector">
          </div>
          <div class="space-y-2">
            <label class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
              for="catregory">
              Category
            </label>
            {% for category in film.category%}
            <input name="category" id="category{{category.id}}" oninput="search2('{{category.id}}', event)"
              class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
              type="text" required="true" value="{{category.name}}" />
            <div class="" id="showcategory{{category.id}}">

            </div>
            {% endfor %}
          </div>
          <div class="space-y-2">
            <label class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
              for="actor">
              Main actor
            </label>
            <input name="actor" id="actor"
              class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
              type="text" required="true" value="{{film.actor.name}}" />
            <div class="" id="showactor">
            </div>

            <div class="space-y-2">
              <label class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
                for="rating">
                Rating
              </label>

              <input name="rating" id="rating"
                class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
                type="number" required="true" value=0 />

            </div>
            <input type="hidden" name="csrf_token" value="{{csrf_token()}}" />
          </div>


          <label class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
            for="trailer">
            Trailer
          </label>
          <input name="trailer" id="trailer"
            class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
            type="text" required="true" value={{film.trailer}} />



          <div class="space-y-2">
            <label class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
              for="image">
              Image
            </label>
            <input
              class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
              id="image" name="image" type="file" />

          </div>


          <div class="flex items-center p-6">
            <button type="submit"
              class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium bg-black ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-white hover:bg-slate-700 h-10 px-4 py-2 w-full">
              Edit film
            </button>
          </div>

    </form>
  </div>
</div>
{% endblock %}


{% block scripts %}
<script>
  function search2(id, event) {
    let target = document.getElementById("showcategory" + id);
    let value = event.target.value; // accessing the value through event.target
    console.log(value);
    if (value.length < 3) {
      target.innerHTML = "";
      return;
    }
    fetch(`/api/category?search=${value}`)
      .then((response) => response.json())
      .then((data) => {
        console.log(data);
        target.innerHTML = "";
        data.forEach((element) => {
          let div = document.createElement("div");
          div.innerHTML = element.name;
          div.addEventListener("click", function () {
            document.getElementById("category" + id).value = element.name;
            target.innerHTML = "";
          });
          target.appendChild(div);
        });
      });
  }
</script>
{% endblock %}